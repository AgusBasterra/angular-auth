<div class="auth-container">
  <div class="auth-card">
    <h1 class="auth-title">Nueva Contraseña</h1>

    @if (errorMessage()) {
      <div class="alert alert-error">{{ errorMessage() }}</div>
    }

    @if (successMessage()) {
      <div class="alert alert-success">{{ successMessage() }}</div>
    }

    <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" class="auth-form">
      <div class="form-group">
        <label for="newPassword" class="form-label">Nueva Contraseña</label>
        <input
          id="newPassword"
          type="password"
          formControlName="newPassword"
          class="form-input"
          placeholder="••••••••"
          [class.invalid]="resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched"
        />
        @if (resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched) {
          <div class="form-error">
            @if (resetForm.get('newPassword')?.hasError('required')) {
              La contraseña es requerida
            }
            @if (resetForm.get('newPassword')?.hasError('minlength')) {
              La contraseña debe tener al menos 6 caracteres
            }
          </div>
        }
      </div>

      <div class="form-group">
        <label for="confirmPassword" class="form-label">Confirmar Contraseña</label>
        <input
          id="confirmPassword"
          type="password"
          formControlName="confirmPassword"
          class="form-input"
          placeholder="••••••••"
          [class.invalid]="resetForm.get('confirmPassword')?.invalid && resetForm.get('confirmPassword')?.touched"
        />
        @if (resetForm.get('confirmPassword')?.invalid && resetForm.get('confirmPassword')?.touched) {
          <div class="form-error">
            @if (resetForm.get('confirmPassword')?.hasError('required')) {
              Confirma tu contraseña
            }
            @if (resetForm.get('confirmPassword')?.hasError('passwordMismatch')) {
              Las contraseñas no coinciden
            }
          </div>
        }
      </div>

      <button type="submit" class="btn btn-primary btn-block" [disabled]="isLoading() || resetForm.invalid || !token()">
        @if (isLoading()) {
          <span class="spinner"></span>
          Restableciendo...
        } @else {
          Restablecer Contraseña
        }
      </button>

      <div class="form-footer">
        <a (click)="goToLogin()" class="link">Volver a Iniciar Sesión</a>
      </div>
    </form>
  </div>
</div>

